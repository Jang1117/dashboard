<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jang's Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f0f;
            --bg-secondary: #1a1a1a;
            --bg-card: #222222;
            --bg-hover: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            --accent: #4ecdc4;
            --accent-hover: #45b7aa;
            --border: #333333;
            --success: #4ade80;
            --warning: #fbbf24;
            --danger: #f87171;
            --memo-yellow: #fef3c7;
            --memo-pink: #fce7f3;
            --memo-blue: #dbeafe;
            --memo-green: #d1fae5;
            --memo-purple: #ede9fe;
            --naver-green: #03c75a;
            --daum-blue: #1e90ff;
            --google-blue: #4285f4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            line-height: 1.6;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 30px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header h1 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--accent);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .current-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Weather in Header */
        .weather-inline {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-card);
            padding: 8px 16px;
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .weather-icon {
            font-size: 1.5rem;
        }

        .weather-temp {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .weather-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .weather-location {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 16px;
            padding: 16px 30px;
            max-width: 1600px;
            margin: 0 auto;
            height: calc(100vh - 70px);
        }

        /* Card Base */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px;
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            border-color: var(--accent);
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-title-icon {
            color: var(--accent);
        }

        .card-actions {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .card-btn {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 5px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .card-btn:hover {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        /* --- Bookmarks Grouped Style --- */
        .bookmarks-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 4px;
        }

        .bookmark-group {
            margin-bottom: 16px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid var(--border);
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .group-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent);
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .group-title:hover { background: var(--bg-hover); }

        .bookmarks-grid-inner {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 8px;
        }

        .bookmark-item {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: var(--text-primary);
            position: relative;
            height: 42px;
        }

        .bookmark-item:hover {
            background: var(--bg-hover);
            transform: translateY(-2px);
            border-color: var(--accent);
        }

        .bookmark-icon {
            width: 24px;
            height: 24px;
            min-width: 24px;
            background: var(--bg-hover);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .bookmark-name {
            font-size: 0.75rem;
            text-align: left;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }

        /* ê³ ì •: ì‚­ì œ ë²„íŠ¼ ìœ„ì¹˜ ìˆ˜ì • (ë‚´ë¶€ë¡œ ì˜®ê²¨ ì˜ë¦¼ ë°©ì§€) */
        .bookmark-delete {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 16px;
            height: 16px;
            background: var(--danger);
            border: none;
            border-radius: 4px;
            color: white;
            font-size: 10px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .bookmark-item:hover .bookmark-delete {
            display: flex;
        }

        /* Calendar Widget - Weekly View */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .calendar-nav {
            display: flex;
            gap: 6px;
        }

        .calendar-nav button {
            background: var(--bg-hover);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 4px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .calendar-nav button:hover {
            background: var(--accent);
            color: var(--bg-primary);
        }

        .calendar-week-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .google-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--bg-secondary);
            border-radius: 6px;
            margin-bottom: 8px;
            font-size: 0.75rem;
        }

        .google-status.connected {
            border: 1px solid #4285f4;
        }

        .google-status.disconnected {
            border: 1px solid var(--border);
        }

        .google-status-text {
            flex: 1;
            color: var(--text-secondary);
        }

        .google-btn {
            background: #4285f4;
            border: none;
            color: white;
            padding: 4px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.2s;
        }

        .google-btn:hover {
            background: #3367d6;
        }

        .google-btn.disconnect {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        .google-btn.disconnect:hover {
            background: var(--danger);
            color: white;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 10px;
        }

        .week-day {
            text-align: center;
            padding: 8px 4px;
            background: var(--bg-secondary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .week-day:hover {
            background: var(--bg-hover);
        }

        .week-day.today {
            background: var(--accent);
            color: var(--bg-primary);
        }

        .week-day.today .week-day-name {
            color: var(--bg-primary);
        }

        .week-day.selected {
            border-color: var(--accent);
            background: rgba(78, 205, 196, 0.15);
        }

        .week-day-name {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-bottom: 2px;
        }

        .week-day-num {
            font-size: 1rem;
            font-weight: 600;
        }

        .week-day-dots {
            display: flex;
            justify-content: center;
            gap: 2px;
            margin-top: 4px;
            min-height: 5px;
        }

        .event-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: var(--accent);
        }

        .week-day.today .event-dot {
            background: var(--bg-primary);
        }

        .events-date-header {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--border);
        }

        .events-list {
            height: 88px;
            min-height: 88px;
            max-height: 88px;
            overflow-y: auto;
        }

        .event-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            background: var(--bg-secondary);
            border-radius: 6px;
            margin-bottom: 4px;
            border-left: 3px solid var(--accent);
            font-size: 0.85rem;
        }

        .event-item.google-event {
            border-left-color: #4285f4;
        }

        .event-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--accent);
            min-width: 80px;
        }

        .event-item.google-event .event-time {
            color: #4285f4;
        }

        .event-title {
            flex: 1;
        }

        .event-source {
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-hover);
            padding: 2px 5px;
            border-radius: 3px;
        }

        .event-empty {
            text-align: center;
            color: var(--text-muted);
            padding: 30px 16px;
            font-size: 0.85rem;
        }

        /* Memo Widget - Post-it Style */
        .memo-container {
            min-height: 200px;
            max-height: 200px;
        }

        .memo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 4px;
        }

        .memo-postit {
            background: var(--memo-yellow);
            border-radius: 4px;
            padding: 10px;
            min-height: 90px;
            max-height: 90px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .memo-postit:hover {
            transform: translateY(-3px) rotate(1deg);
            box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.4);
        }

        .memo-postit.yellow { background: var(--memo-yellow); }
        .memo-postit.pink { background: var(--memo-pink); }
        .memo-postit.blue { background: var(--memo-blue); }
        .memo-postit.green { background: var(--memo-green); }
        .memo-postit.purple { background: var(--memo-purple); }

        .memo-postit-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .memo-postit-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: #333;
            flex: 1;
            word-break: break-word;
        }

        .memo-postit-date {
            font-size: 0.65rem;
            color: #666;
        }

        .memo-postit-content {
            font-size: 0.7rem;
            color: #444;
            flex: 1;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-height: 1.3;
            word-break: break-word;
        }

        .memo-postit-delete {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 18px;
            height: 18px;
            background: rgba(0, 0, 0, 0.3);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 10px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .memo-postit:hover .memo-postit-delete {
            display: flex;
        }

        .memo-postit-add {
            background: var(--bg-secondary);
            border: 2px dashed var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 2rem;
        }

        .memo-postit-add:hover {
            border-color: var(--accent);
            color: var(--accent);
            transform: none;
            box-shadow: none;
        }

        /* News Widget */
        .news-keyword-bar {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .news-keyword {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .news-keyword:hover,
        .news-keyword.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .news-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .news-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            background: var(--bg-secondary);
            border-radius: 5px;
            margin-bottom: 4px;
            text-decoration: none;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .news-item:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
        }

        .news-title {
            color: var(--text-primary);
            font-size: 0.78rem;
            line-height: 1.3;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .news-time {
            font-size: 0.7rem;
            color: var(--text-muted);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .news-loading {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.85rem;
            line-height: 1.6;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px 12px;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-color-options {
            display: flex;
            gap: 8px;
        }

        .color-option {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .color-option:hover, .color-option.selected {
            transform: scale(1.1);
            border-color: var(--text-primary);
        }

        .color-option.yellow { background: var(--memo-yellow); }
        .color-option.pink { background: var(--memo-pink); }
        .color-option.blue { background: var(--memo-blue); }
        .color-option.green { background: var(--memo-green); }
        .color-option.purple { background: var(--memo-purple); }

        .form-submit {
            width: 100%;
            background: var(--accent);
            border: none;
            color: var(--bg-primary);
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .form-submit:hover {
            background: var(--accent-hover);
        }

        /* Settings Dropdown */
        .settings-dropdown {
            position: relative;
        }

        .settings-btn {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .settings-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .settings-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 8px;
            min-width: 180px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .settings-menu.active {
            display: block;
        }

        .settings-menu button {
            display: block;
            width: 100%;
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 10px 12px;
            text-align: left;
            cursor: pointer;
            border-radius: 6px;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .settings-menu button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 5px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
Â  Â  Â  Â  <header class="header">
Â  Â  Â  Â  <div class="header-left">
Â  Â  Â  Â  Â  Â  <h1>Jang's Dashboard</h1>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="header-right">
Â  Â  Â  Â  Â  Â  <div class="weather-inline" id="weatherWidget">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="weather-icon" id="weatherIcon">ğŸŒ¡ï¸</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="weather-temp" id="weatherTemp">--Â°</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="weather-desc" id="weatherDesc">ë¡œë”©ì¤‘...</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="weather-location" id="weatherLocation">ğŸ“ --</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="current-time" id="currentTime">00:00:00</div>
Â  Â  Â  Â  Â  Â  <div class="settings-dropdown">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="settings-btn" onclick="toggleSettingsMenu()">âš™ï¸ ì„¤ì •</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="settings-menu" id="settingsMenu">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="exportToJson()">ğŸ“¥ JSON ë‚´ë³´ë‚´ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="document.getElementById('jsonFileInput').click()">ğŸ“¤ JSON ë¶ˆëŸ¬ì˜¤ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="jsonFileInput" accept=".json" style="display:none" onchange="importFromJson(event)">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </header>

Â  Â  Â  Â  <main class="main-container">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-title-icon">â­</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ì¦ê²¨ì°¾ëŠ” ì‚¬ì´íŠ¸
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="card-btn" onclick="addGroup()">+ ê·¸ë£¹</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="bookmarks-container" id="bookmarksGrid"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-title-icon">ğŸ“…</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ì£¼ê°„ ì¼ì •
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="card-btn" onclick="openAddEventModal()">+ ì¼ì •</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="google-status disconnected" id="googleStatus">
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ“†</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="google-status-text" id="googleStatusText">Google ìº˜ë¦°ë” ì—°ê²° ì•ˆë¨</span>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="google-btn" id="googleBtn" onclick="handleGoogleAuth()">ì—°ê²°</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="google-btn" id="googleCalendarSelectBtn" onclick="openCalendarSelectModal()" style="display:none;">ìº˜ë¦°ë” ì„ íƒ</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="calendar-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="calendar-nav">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="changeWeek(-1)">â—€</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="goToToday()">ì˜¤ëŠ˜</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="changeWeek(1)">â–¶</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="calendar-week-label" id="calendarWeekLabel">1ì›” 2ì£¼ì°¨</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="week-grid" id="weekGrid"></div>
Â  Â  Â  Â  Â  Â  <div id="selectedDateHeader" class="events-date-header"></div>
Â  Â  Â  Â  Â  Â  <div class="events-list" id="eventsList"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-title-icon">ğŸ“</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ë©”ëª¨
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="card-btn" onclick="exportAllMemos()">ë‚´ë³´ë‚´ê¸°</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="memo-container">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-grid" id="memoGrid"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-title-icon">ğŸ“°</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ë‰´ìŠ¤
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="card-btn" onclick="openKeywordModal()">í‚¤ì›Œë“œ</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="card-btn" onclick="refreshNews()">ìƒˆë¡œê³ ì¹¨</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="news-keyword-bar" id="newsKeywords"></div>
Â  Â  Â  Â  Â  Â  <div class="news-list" id="newsList">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="news-loading">ë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  Â  Â  <div class="modal-overlay" id="bookmarkModal">
Â  Â  Â  Â  <div class="modal">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-title">ì¦ê²¨ì°¾ê¸° ì¶”ê°€</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="modal-close" onclick="closeModal('bookmarkModal')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <form onsubmit="addBookmark(event)">
                <div class="form-group">
                    <label class="form-label">ê·¸ë£¹ ì„ íƒ</label>
                    <select class="form-select" id="bookmarkGroupSelect"></select>
                </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ì‚¬ì´íŠ¸ ì´ë¦„</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" id="bookmarkName" placeholder="ì˜ˆ: Google" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">URL</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="url" class="form-input" id="bookmarkUrl" placeholder="https://..." required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" id="bookmarkIcon" placeholder="ğŸŒ" maxlength="2">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="form-submit">ì¶”ê°€í•˜ê¸°</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div class="modal-overlay" id="eventModal">
Â  Â  Â  Â  <div class="modal">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-title">ì¼ì • ì¶”ê°€</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="modal-close" onclick="closeModal('eventModal')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <form onsubmit="addEvent(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ì¼ì • ì œëª©</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" id="eventTitle" placeholder="íšŒì˜, ì•½ì† ë“±" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ë‚ ì§œ</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="date" class="form-input" id="eventDate" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ì‹œê°„</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="time" class="form-input" id="eventTime">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="form-submit">ì¶”ê°€í•˜ê¸°</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div class="modal-overlay" id="memoModal">
Â  Â  Â  Â  <div class="modal">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-title" id="memoModalTitle">ë©”ëª¨ ì¶”ê°€</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="modal-close" onclick="closeModal('memoModal')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <form onsubmit="saveMemo(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" id="memoEditIndex" value="-1">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ì œëª©</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" id="memoTitle" placeholder="ë©”ëª¨ ì œëª©" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ë‚´ìš©</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea class="form-textarea" id="memoContent" placeholder="ë©”ëª¨ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ìƒ‰ìƒ</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-color-options" id="colorOptions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="color-option yellow selected" data-color="yellow" onclick="selectColor('yellow')"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="color-option pink" data-color="pink" onclick="selectColor('pink')"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="color-option blue" data-color="blue" onclick="selectColor('blue')"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="color-option green" data-color="green" onclick="selectColor('green')"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="color-option purple" data-color="purple" onclick="selectColor('purple')"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="form-submit">ì €ì¥í•˜ê¸°</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div class="modal-overlay" id="keywordModal">
Â  Â  Â  Â  <div class="modal">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-title">ë‰´ìŠ¤ í‚¤ì›Œë“œ ê´€ë¦¬</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="modal-close" onclick="closeModal('keywordModal')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <form onsubmit="addKeyword(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">ìƒˆ í‚¤ì›Œë“œ</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" id="newKeyword" placeholder="ì˜ˆ: AI, ì£¼ì‹, ë¶€ë™ì‚°" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="form-submit">ì¶”ê°€í•˜ê¸°</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  <div style="margin-top: 16px;">
Â  Â  Â  Â  Â  Â  Â  Â  <label class="form-label">í˜„ì¬ í‚¤ì›Œë“œ (í´ë¦­í•˜ì—¬ ì‚­ì œ)</label>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="keywordList" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div class="modal-overlay" id="calendarSelectModal">
Â  Â  Â  Â  <div class="modal">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-title">í‘œì‹œí•  ìº˜ë¦°ë” ì„ íƒ</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="modal-close" onclick="closeModal('calendarSelectModal')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="calendarList" style="max-height: 300px; overflow-y: auto;">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="news-loading">ìº˜ë¦°ë” ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button class="form-submit" onclick="saveCalendarSelection()" style="margin-top: 16px;">ì €ì¥</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â  <script>
Â  Â  Â  Â  // ==================== State Management ====================
Â  Â  Â  Â  let state = {
            bookmarkGroups: [{ name: "ê¸°ë³¸", items: [] }],
Â  Â  Â  Â  Â  Â  events: [],
Â  Â  Â  Â  Â  Â  googleEvents: [],
Â  Â  Â  Â  Â  Â  googleCalendars: [],
Â  Â  Â  Â  Â  Â  selectedCalendars: [],
Â  Â  Â  Â  Â  Â  memos: [],
Â  Â  Â  Â  Â  Â  newsKeywords: ['IT', 'ê²½ì œ', 'ë¶€ë™ì‚°'],
Â  Â  Â  Â  Â  Â  activeKeyword: 'IT',
Â  Â  Â  Â  Â  Â  newsProvider: 'naver',
Â  Â  Â  Â  Â  Â  currentWeekStart: null,
Â  Â  Â  Â  Â  Â  selectedDate: null,
Â  Â  Â  Â  Â  Â  googleConnected: false,
Â  Â  Â  Â  Â  Â  googleAccessToken: null,
Â  Â  Â  Â  Â  Â  selectedMemoColor: 'yellow'
Â  Â  Â  Â  };

Â  Â  Â  Â  // Google Calendar API
Â  Â  Â  Â  const GOOGLE_CLIENT_ID = '616051020242-mg4r2ccc0iks3ssqhjuula6f1sr1o0p8.apps.googleusercontent.com';
Â  Â  Â  Â  const GOOGLE_SCOPES = 'https://www.googleapis.com/auth/calendar.readonly';

Â  Â  Â  Â  // ë¡œì»¬ ë‚ ì§œ ë¬¸ìì—´ ìƒì„± (timezone ë¬¸ì œ í•´ê²°)
Â  Â  Â  Â  function getLocalDateStr(date) {
Â  Â  Â  Â  Â  Â  const d = date || new Date();
Â  Â  Â  Â  Â  Â  const year = d.getFullYear();
Â  Â  Â  Â  Â  Â  const month = String(d.getMonth() + 1).padStart(2, '0');
Â  Â  Â  Â  Â  Â  const day = String(d.getDate()).padStart(2, '0');
Â  Â  Â  Â  Â  Â  return `${year}-${month}-${day}`;
Â  Â  Â  Â  }

Â  Â  Â  Â  // ë‚ ì§œ ë¬¸ìì—´ì—ì„œ Date ê°ì²´ ìƒì„± (ë¡œì»¬ ì‹œê°„ ê¸°ì¤€)
Â  Â  Â  Â  function parseLocalDate(dateStr) {
Â  Â  Â  Â  Â  Â  const [year, month, day] = dateStr.split('-').map(Number);
Â  Â  Â  Â  Â  Â  return new Date(year, month - 1, day);
Â  Â  Â  Â  }

Â  Â  Â  Â  function getWeekStart(date) {
Â  Â  Â  Â  Â  Â  const d = new Date(date);
Â  Â  Â  Â  Â  Â  const day = d.getDay();
Â  Â  Â  Â  Â  Â  d.setDate(d.getDate() - day);
Â  Â  Â  Â  Â  Â  d.setHours(0, 0, 0, 0);
Â  Â  Â  Â  Â  Â  return d;
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Initialize ====================
Â  Â  Â  Â  function init() {
Â  Â  Â  Â  Â  Â  state.currentWeekStart = getWeekStart(new Date());
Â  Â  Â  Â  Â  Â  state.selectedDate = getLocalDateStr(new Date());
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  loadState();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // OAuth ì½œë°± ì²˜ë¦¬ (ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ URL í•´ì‹œì—ì„œ í† í° ì¶”ì¶œ)
Â  Â  Â  Â  Â  Â  handleOAuthCallback();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateTime();
Â  Â  Â  Â  Â  Â  setInterval(updateTime, 1000);
Â  Â  Â  Â  Â  Â  getWeather();
Â  Â  Â  Â  Â  Â  renderBookmarks();
Â  Â  Â  Â  Â  Â  updateGoogleStatus();
Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  renderMemos();
Â  Â  Â  Â  Â  Â  renderNewsKeywords();
Â  Â  Â  Â  Â  Â  loadNews();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (state.googleConnected) {
Â  Â  Â  Â  Â  Â  Â  Â  fetchGoogleCalendarList();
Â  Â  Â  Â  Â  Â  Â  Â  fetchGoogleCalendarEvents();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Local Storage ====================
Â  Â  Â  Â  function loadState() {
Â  Â  Â  Â  Â  Â  const saved = localStorage.getItem('dashboardState_v5');
Â  Â  Â  Â  Â  Â  if (saved) {
Â  Â  Â  Â  Â  Â  Â  Â  const parsed = JSON.parse(saved);
Â  Â  Â  Â  Â  Â  Â  Â  state = { ...state, ...parsed };
                // ê¸°ì¡´ ë°ì´í„°ê°€ state.bookmarksì— ìˆëŠ” ê²½ìš° ë§ˆì´ê·¸ë ˆì´ì…˜
                if (parsed.bookmarks && !parsed.bookmarkGroups) {
                    state.bookmarkGroups = [{ name: "ê¸°ë³¸", items: parsed.bookmarks }];
                }
Â  Â  Â  Â  Â  Â  Â  Â  state.currentWeekStart = getWeekStart(new Date());
Â  Â  Â  Â  Â  Â  Â  Â  state.selectedDate = getLocalDateStr(new Date());
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const googleToken = localStorage.getItem('googleAccessToken');
Â  Â  Â  Â  Â  Â  if (googleToken) {
Â  Â  Â  Â  Â  Â  Â  Â  state.googleAccessToken = googleToken;
Â  Â  Â  Â  Â  Â  Â  Â  state.googleConnected = true;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveState() {
Â  Â  Â  Â  Â  Â  const toSave = {
Â  Â  Â  Â  Â  Â  Â  Â  bookmarkGroups: state.bookmarkGroups,
Â  Â  Â  Â  Â  Â  Â  Â  events: state.events,
Â  Â  Â  Â  Â  Â  Â  Â  memos: state.memos,
Â  Â  Â  Â  Â  Â  Â  Â  newsKeywords: state.newsKeywords,
Â  Â  Â  Â  Â  Â  Â  Â  newsProvider: state.newsProvider,
Â  Â  Â  Â  Â  Â  Â  Â  selectedCalendars: state.selectedCalendars
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  localStorage.setItem('dashboardState_v5', JSON.stringify(toSave));
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== JSON Export/Import ====================
Â  Â  Â  Â  function toggleSettingsMenu() {
Â  Â  Â  Â  Â  Â  const menu = document.getElementById('settingsMenu');
Â  Â  Â  Â  Â  Â  menu.classList.toggle('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  document.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  const dropdown = document.querySelector('.settings-dropdown');
Â  Â  Â  Â  Â  Â  const menu = document.getElementById('settingsMenu');
Â  Â  Â  Â  Â  Â  if (dropdown && !dropdown.contains(e.target)) {
Â  Â  Â  Â  Â  Â  Â  Â  menu.classList.remove('active');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  function exportToJson() {
Â  Â  Â  Â  Â  Â  const exportData = {
Â  Â  Â  Â  Â  Â  Â  Â  version: '1.1',
Â  Â  Â  Â  Â  Â  Â  Â  exportDate: getLocalDateStr(new Date()),
Â  Â  Â  Â  Â  Â  Â  Â  bookmarkGroups: state.bookmarkGroups,
Â  Â  Â  Â  Â  Â  Â  Â  events: state.events,
Â  Â  Â  Â  Â  Â  Â  Â  memos: state.memos,
Â  Â  Â  Â  Â  Â  Â  Â  newsKeywords: state.newsKeywords,
Â  Â  Â  Â  Â  Â  Â  Â  newsProvider: state.newsProvider,
Â  Â  Â  Â  Â  Â  Â  Â  selectedCalendars: state.selectedCalendars
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
Â  Â  Â  Â  Â  Â  const url = URL.createObjectURL(blob);
Â  Â  Â  Â  Â  Â  const a = document.createElement('a');
Â  Â  Â  Â  Â  Â  a.href = url;
Â  Â  Â  Â  Â  Â  a.download = `dashboard_backup_${getLocalDateStr(new Date())}.json`;
Â  Â  Â  Â  Â  Â  a.click();
Â  Â  Â  Â  Â  Â  URL.revokeObjectURL(url);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('settingsMenu').classList.remove('active');
Â  Â  Â  Â  Â  Â  alert('ì„¤ì •ì´ JSON íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
Â  Â  Â  Â  }

Â  Â  Â  Â  function importFromJson(event) {
Â  Â  Â  Â  Â  Â  const file = event.target.files[0];
Â  Â  Â  Â  Â  Â  if (!file) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  reader.onload = (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const importData = JSON.parse(e.target.result);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.bookmarkGroups) state.bookmarkGroups = importData.bookmarkGroups;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.events) state.events = importData.events;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.memos) state.memos = importData.memos;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.newsKeywords) state.newsKeywords = importData.newsKeywords;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.newsProvider) state.newsProvider = importData.newsProvider;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (importData.selectedCalendars) state.selectedCalendars = importData.selectedCalendars;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderBookmarks();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderMemos();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderNewsKeywords();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadNews();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('JSON íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(err);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  reader.readAsText(file);
Â  Â  Â  Â  Â  Â  event.target.value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('settingsMenu').classList.remove('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Time ====================
Â  Â  Â  Â  function updateTime() {
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  document.getElementById('currentTime').textContent = now.toLocaleTimeString('ko-KR', { hour12: false });
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Weather ====================
Â  Â  Â  Â  async function getWeather() {
Â  Â  Â  Â  Â  Â  if (navigator.geolocation) {
Â  Â  Â  Â  Â  Â  Â  Â  navigator.geolocation.getCurrentPosition(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pos => fetchWeather(pos.coords.latitude, pos.coords.longitude),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  () => fetchWeather(37.5665, 126.9780)
Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  fetchWeather(37.5665, 126.9780);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function fetchWeather(lat, lon) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&timezone=auto`);
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const temp = Math.round(data.current.temperature_2m);
Â  Â  Â  Â  Â  Â  Â  Â  const code = data.current.weather_code;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('weatherTemp').textContent = temp + 'Â°';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('weatherDesc').textContent = getWeatherDesc(code);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('weatherIcon').textContent = getWeatherIcon(code);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const geoRes = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&accept-language=ko`);
Â  Â  Â  Â  Â  Â  Â  Â  const geoData = await geoRes.json();
Â  Â  Â  Â  Â  Â  Â  Â  const loc = geoData.address.city || geoData.address.town || geoData.address.district || 'ì•Œ ìˆ˜ ì—†ìŒ';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('weatherLocation').textContent = 'ğŸ“ ' + loc;
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('weatherDesc').textContent = 'ë‚ ì”¨ ì •ë³´ ì—†ìŒ';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function getWeatherIcon(code) {
Â  Â  Â  Â  Â  Â  const icons = { 0:'â˜€ï¸', 1:'ğŸŒ¤ï¸', 2:'â›…', 3:'â˜ï¸', 45:'ğŸŒ«ï¸', 48:'ğŸŒ«ï¸', 51:'ğŸŒ§ï¸', 53:'ğŸŒ§ï¸', 55:'ğŸŒ§ï¸', 61:'ğŸŒ§ï¸', 63:'ğŸŒ§ï¸', 65:'ğŸŒ§ï¸', 71:'ğŸŒ¨ï¸', 73:'ğŸŒ¨ï¸', 75:'ğŸŒ¨ï¸', 80:'ğŸŒ§ï¸', 81:'ğŸŒ§ï¸', 82:'ğŸŒ§ï¸', 95:'â›ˆï¸', 96:'â›ˆï¸', 99:'â›ˆï¸' };
Â  Â  Â  Â  Â  Â  return icons[code] || 'ğŸŒ¡ï¸';
Â  Â  Â  Â  }

Â  Â  Â  Â  function getWeatherDesc(code) {
Â  Â  Â  Â  Â  Â  const desc = { 0:'ë§‘ìŒ', 1:'ëŒ€ì²´ë¡œ ë§‘ìŒ', 2:'ë¶€ë¶„ì  íë¦¼', 3:'íë¦¼', 45:'ì•ˆê°œ', 48:'ì•ˆê°œ', 51:'ì´ìŠ¬ë¹„', 53:'ì´ìŠ¬ë¹„', 55:'ì´ìŠ¬ë¹„', 61:'ë¹„', 63:'ë¹„', 65:'í­ìš°', 71:'ëˆˆ', 73:'ëˆˆ', 75:'í­ì„¤', 80:'ì†Œë‚˜ê¸°', 81:'ì†Œë‚˜ê¸°', 82:'í­ìš°', 95:'ë‡Œìš°', 96:'ë‡Œìš°', 99:'ë‡Œìš°' };
Â  Â  Â  Â  Â  Â  return desc[code] || 'ì •ë³´ ì—†ìŒ';
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Bookmarks (Grouped) ====================
Â  Â  Â  Â  function renderBookmarks() {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('bookmarksGrid');
Â  Â  Â  Â  Â  Â Â 
            if (state.bookmarkGroups.length === 0 || (state.bookmarkGroups.length === 1 && state.bookmarkGroups[0].items.length === 0)) {
                state.bookmarkGroups = [{
                    name: "AI ë„êµ¬",
                    items: [
                        { name: 'ChatGPT', url: 'https://chat.openai.com', icon: 'ğŸ¤–' },
                        { name: 'Gemini', url: 'https://gemini.google.com', icon: 'âœ¨' },
                        { name: 'Claude', url: 'https://claude.ai', icon: 'âœï¸' }
                    ]
                }];
                saveState();
            }

            container.innerHTML = state.bookmarkGroups.map((group, gIdx) => `
                <div class="bookmark-group">
                    <div class="group-header">
                        <span class="group-title" onclick="renameGroup(${gIdx})">${group.name} âœï¸</span>
                        <div class="card-actions">
                            <button class="card-btn" onclick="openAddBookmarkModal(${gIdx})">+ í•­ëª©</button>
                            <button class="card-btn" onclick="deleteGroup(${gIdx})" style="color:var(--danger);">Ã—</button>
                        </div>
                    </div>
                    <div class="bookmarks-grid-inner">
                        ${group.items.map((b, i) => `
                            <a href="${b.url}" target="_blank" class="bookmark-item">
                                <button class="bookmark-delete" onclick="deleteBookmark(event, ${gIdx}, ${i})">Ã—</button>
                                <div class="bookmark-icon">${b.icon || 'ğŸ”—'}</div>
                                <div class="bookmark-name">${b.name}</div>
                            </a>
                        `).join('')}
                    </div>
                </div>
            `).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function openAddBookmarkModal(gIdx = 0) {
            const select = document.getElementById('bookmarkGroupSelect');
            select.innerHTML = state.bookmarkGroups.map((g, i) => `<option value="${i}">${g.name}</option>`).join('');
            select.value = gIdx;
Â  Â  Â  Â  Â  Â  document.getElementById('bookmarkModal').classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  function addBookmark(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
            const gIdx = document.getElementById('bookmarkGroupSelect').value;
Â  Â  Â  Â  Â  Â  state.bookmarkGroups[gIdx].items.push({
Â  Â  Â  Â  Â  Â  Â  Â  name: document.getElementById('bookmarkName').value,
Â  Â  Â  Â  Â  Â  Â  Â  url: document.getElementById('bookmarkUrl').value,
Â  Â  Â  Â  Â  Â  Â  Â  icon: document.getElementById('bookmarkIcon').value || 'ğŸ”—'
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  renderBookmarks();
Â  Â  Â  Â  Â  Â  closeModal('bookmarkModal');
Â  Â  Â  Â  Â  Â  e.target.reset();
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteBookmark(e, gIdx, iIdx) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  if (confirm('ì´ ë¶ë§ˆí¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
Â  Â  Â  Â  Â  Â  Â  Â  state.bookmarkGroups[gIdx].items.splice(iIdx, 1);
Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  renderBookmarks();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

        function addGroup() {
            const name = prompt("ìƒˆ ê·¸ë£¹ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:");
            if (name) {
                state.bookmarkGroups.push({ name, items: [] });
                saveState();
                renderBookmarks();
            }
        }

        function renameGroup(idx) {
            const newName = prompt("ê·¸ë£¹ ì´ë¦„ ìˆ˜ì •:", state.bookmarkGroups[idx].name);
            if (newName) {
                state.bookmarkGroups[idx].name = newName;
                saveState();
                renderBookmarks();
            }
        }

        function deleteGroup(idx) {
            if (confirm(`'${state.bookmarkGroups[idx].name}' ê·¸ë£¹ê³¼ ë‚´ë¶€ í•­ëª©ë“¤ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                state.bookmarkGroups.splice(idx, 1);
                if (state.bookmarkGroups.length === 0) state.bookmarkGroups = [{ name: "ê¸°ë³¸", items: [] }];
                saveState();
                renderBookmarks();
            }
        }

Â  Â  Â  Â  // ==================== Calendar (Weekly) ====================
Â  Â  Â  Â  function renderWeeklyCalendar() {
Â  Â  Â  Â  Â  Â  const grid = document.getElementById('weekGrid');
Â  Â  Â  Â  Â  Â  const weekLabel = document.getElementById('calendarWeekLabel');
Â  Â  Â  Â  Â  Â  const weekStart = state.currentWeekStart;
Â  Â  Â  Â  Â  Â  const todayStr = getLocalDateStr(new Date());
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const month = weekStart.getMonth() + 1;
Â  Â  Â  Â  Â  Â  const weekOfMonth = Math.ceil((weekStart.getDate() + weekStart.getDay()) / 7);
Â  Â  Â  Â  Â  Â  weekLabel.textContent = `${weekStart.getFullYear()}ë…„ ${month}ì›” ${weekOfMonth}ì£¼ì°¨`;

Â  Â  Â  Â  Â  Â  const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
Â  Â  Â  Â  Â  Â  let html = '';

Â  Â  Â  Â  Â  Â  for (let i = 0; i < 7; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const date = new Date(weekStart);
Â  Â  Â  Â  Â  Â  Â  Â  date.setDate(date.getDate() + i);
Â  Â  Â  Â  Â  Â  Â  Â  const dateStr = getLocalDateStr(date);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const isToday = dateStr === todayStr;
Â  Â  Â  Â  Â  Â  Â  Â  const isSelected = dateStr === state.selectedDate;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const localEvents = state.events.filter(e => e.date === dateStr);
Â  Â  Â  Â  Â  Â  Â  Â  const googleEvts = state.googleEvents.filter(e => e.date === dateStr);
Â  Â  Â  Â  Â  Â  Â  Â  const allEvents = [...localEvents, ...googleEvts];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let classes = 'week-day';
Â  Â  Â  Â  Â  Â  Â  Â  if (isToday) classes += ' today';
Â  Â  Â  Â  Â  Â  Â  Â  if (isSelected && !isToday) classes += ' selected';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const dots = allEvents.slice(0, 3).map(() => '<span class="event-dot"></span>').join('');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="${classes}" onclick="selectDate('${dateStr}')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="week-day-name">${dayNames[i]}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="week-day-num">${date.getDate()}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="week-day-dots">${dots}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  grid.innerHTML = html;
Â  Â  Â  Â  Â  Â  renderEventsForDate(state.selectedDate);
Â  Â  Â  Â  }

Â  Â  Â  Â  function changeWeek(delta) {
Â  Â  Â  Â  Â  Â  state.currentWeekStart.setDate(state.currentWeekStart.getDate() + (delta * 7));
Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  if (state.googleConnected) fetchGoogleCalendarEvents();
Â  Â  Â  Â  }

Â  Â  Â  Â  function goToToday() {
Â  Â  Â  Â  Â  Â  state.currentWeekStart = getWeekStart(new Date());
Â  Â  Â  Â  Â  Â  state.selectedDate = getLocalDateStr(new Date());
Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  if (state.googleConnected) fetchGoogleCalendarEvents();
Â  Â  Â  Â  }

Â  Â  Â  Â  function selectDate(dateStr) {
Â  Â  Â  Â  Â  Â  state.selectedDate = dateStr;
Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderEventsForDate(dateStr) {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('eventsList');
Â  Â  Â  Â  Â  Â  const header = document.getElementById('selectedDateHeader');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const date = parseLocalDate(dateStr);
Â  Â  Â  Â  Â  Â  header.textContent = date.toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', weekday: 'long' });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const localEvents = state.events.filter(e => e.date === dateStr).map(e => ({ ...e, source: 'local' }));
Â  Â  Â  Â  Â  Â  const googleEvts = state.googleEvents.filter(e => e.date === dateStr).map(e => ({ ...e, source: 'google' }));
Â  Â  Â  Â  Â  Â  const allEvents = [...localEvents, ...googleEvts].sort((a, b) => (a.time || '').localeCompare(b.time || ''));

Â  Â  Â  Â  Â  Â  if (allEvents.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = '<div class="event-empty">ì´ ë‚ ì˜ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤</div>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  list.innerHTML = allEvents.map((e, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  const isGoogle = e.source === 'google';
Â  Â  Â  Â  Â  Â  Â  Â  const timeDisplay = e.time || 'ì¢…ì¼';
Â  Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="event-item ${isGoogle ? 'google-event' : ''}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="event-time">${timeDisplay}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="event-title">${e.title}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${isGoogle ? '<span class="event-source">Google</span>' : `<button class="card-btn" onclick="deleteEvent('${e.date}', '${e.title}', '${e.time || ''}')" style="padding:3px 6px;font-size:0.7rem;">ì‚­ì œ</button>`}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function openAddEventModal() {
Â  Â  Â  Â  Â  Â  document.getElementById('eventModal').classList.add('active');
Â  Â  Â  Â  Â  Â  document.getElementById('eventDate').value = state.selectedDate;
Â  Â  Â  Â  }

Â  Â  Â  Â  function addEvent(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  state.events.push({
Â  Â  Â  Â  Â  Â  Â  Â  title: document.getElementById('eventTitle').value,
Â  Â  Â  Â  Â  Â  Â  Â  date: document.getElementById('eventDate').value,
Â  Â  Â  Â  Â  Â  Â  Â  time: document.getElementById('eventTime').value
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  closeModal('eventModal');
Â  Â  Â  Â  Â  Â  e.target.reset();
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteEvent(date, title, time) {
Â  Â  Â  Â  Â  Â  const idx = state.events.findIndex(e => e.date === date && e.title === title && (e.time || '') === time);
Â  Â  Â  Â  Â  Â  if (idx > -1) {
Â  Â  Â  Â  Â  Â  Â  Â  state.events.splice(idx, 1);
Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Google Calendar ====================
Â  Â  Â  Â  function updateGoogleStatus() {
Â  Â  Â  Â  Â  Â  const statusEl = document.getElementById('googleStatus');
Â  Â  Â  Â  Â  Â  const textEl = document.getElementById('googleStatusText');
Â  Â  Â  Â  Â  Â  const btnEl = document.getElementById('googleBtn');
Â  Â  Â  Â  Â  Â  const selectBtnEl = document.getElementById('googleCalendarSelectBtn');

Â  Â  Â  Â  Â  Â  if (state.googleConnected) {
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.classList.remove('disconnected');
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.classList.add('connected');
Â  Â  Â  Â  Â  Â  Â  Â  textEl.textContent = 'Google ìº˜ë¦°ë” ì—°ê²°ë¨';
Â  Â  Â  Â  Â  Â  Â  Â  btnEl.textContent = 'ì—°ê²° í•´ì œ';
Â  Â  Â  Â  Â  Â  Â  Â  btnEl.classList.add('disconnect');
Â  Â  Â  Â  Â  Â  Â  Â  selectBtnEl.style.display = 'inline-block';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.classList.remove('connected');
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.classList.add('disconnected');
Â  Â  Â  Â  Â  Â  Â  Â  textEl.textContent = 'Google ìº˜ë¦°ë” ì—°ê²° ì•ˆë¨';
Â  Â  Â  Â  Â  Â  Â  Â  btnEl.textContent = 'ì—°ê²°';
Â  Â  Â  Â  Â  Â  Â  Â  btnEl.classList.remove('disconnect');
Â  Â  Â  Â  Â  Â  Â  Â  selectBtnEl.style.display = 'none';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleGoogleAuth() {
Â  Â  Â  Â  Â  Â  if (state.googleConnected) {
Â  Â  Â  Â  Â  Â  Â  Â  // ì—°ê²° í•´ì œ
Â  Â  Â  Â  Â  Â  Â  Â  state.googleConnected = false;
Â  Â  Â  Â  Â  Â  Â  Â  state.googleAccessToken = null;
Â  Â  Â  Â  Â  Â  Â  Â  state.googleEvents = [];
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('googleAccessToken');
Â  Â  Â  Â  Â  Â  Â  Â  updateGoogleStatus();
Â  Â  Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°©ì‹ OAuth (ë™ì  URI)
Â  Â  Â  Â  Â  Â  const redirectUri = window.location.origin + window.location.pathname;
Â  Â  Â  Â  Â  Â  console.log('OAuth Redirect URI:', redirectUri);
Â  Â  Â  Â  Â  Â  const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${GOOGLE_CLIENT_ID}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=token&scope=${encodeURIComponent(GOOGLE_SCOPES)}&prompt=consent`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  window.location.href = authUrl;
Â  Â  Â  Â  }

Â  Â  Â  Â  // OAuth ì½œë°± ì²˜ë¦¬ (ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„)
Â  Â  Â  Â  function handleOAuthCallback() {
Â  Â  Â  Â  Â  Â  const hash = window.location.hash;
Â  Â  Â  Â  Â  Â  if (hash && hash.includes('access_token')) {
Â  Â  Â  Â  Â  Â  Â  Â  const params = new URLSearchParams(hash.substring(1));
Â  Â  Â  Â  Â  Â  Â  Â  const accessToken = params.get('access_token');
Â  Â  Â  Â  Â  Â  Â  Â  if (accessToken) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.googleAccessToken = accessToken;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.googleConnected = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('googleAccessToken', accessToken);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // URLì—ì„œ í•´ì‹œ ì œê±°
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.history.replaceState({}, document.title, window.location.pathname);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGoogleStatus();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetchGoogleCalendarList();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetchGoogleCalendarEvents();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function fetchGoogleCalendarList() {
Â  Â  Â  Â  Â  Â  if (!state.googleAccessToken) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('https://www.googleapis.com/calendar/v3/users/me/calendarList', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Authorization': `Bearer ${state.googleAccessToken}` }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.googleCalendars = data.items || [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (state.selectedCalendars.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.selectedCalendars = state.googleCalendars.map(c => c.id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Calendar list error:', e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function openCalendarSelectModal() {
Â  Â  Â  Â  Â  Â  document.getElementById('calendarSelectModal').classList.add('active');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (state.googleCalendars.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  await fetchGoogleCalendarList();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  renderCalendarList();
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderCalendarList() {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('calendarList');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (state.googleCalendars.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = '<div class="news-loading">ìº˜ë¦°ë”ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  list.innerHTML = state.googleCalendars.map(cal => {
Â  Â  Â  Â  Â  Â  Â  Â  const isChecked = state.selectedCalendars.includes(cal.id);
Â  Â  Â  Â  Â  Â  Â  Â  const bgColor = cal.backgroundColor || '#4285f4';
Â  Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 8px; cursor: pointer;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" value="${cal.id}" ${isChecked ? 'checked' : ''} style="width: 18px; height: 18px; accent-color: ${bgColor};">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="width: 12px; height: 12px; background: ${bgColor}; border-radius: 3px;"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="flex: 1; color: var(--text-primary);">${cal.summary}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveCalendarSelection() {
Â  Â  Â  Â  Â  Â  const checkboxes = document.querySelectorAll('#calendarList input[type="checkbox"]');
Â  Â  Â  Â  Â  Â  state.selectedCalendars = Array.from(checkboxes)
Â  Â  Â  Â  Â  Â  Â  Â  .filter(cb => cb.checked)
Â  Â  Â  Â  Â  Â  Â  Â  .map(cb => cb.value);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  closeModal('calendarSelectModal');
Â  Â  Â  Â  Â  Â  fetchGoogleCalendarEvents();
Â  Â  Â  Â  }

Â  Â  Â  Â  async function fetchGoogleCalendarEvents() {
Â  Â  Â  Â  Â  Â  if (!state.googleAccessToken) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const weekStart = new Date(state.currentWeekStart);
Â  Â  Â  Â  Â  Â  Â  Â  const weekEnd = new Date(weekStart);
Â  Â  Â  Â  Â  Â  Â  Â  weekEnd.setDate(weekEnd.getDate() + 7);

Â  Â  Â  Â  Â  Â  Â  Â  const calendarsToFetch = state.selectedCalendars.length > 0Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? state.selectedCalendarsÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : ['primary'];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let allEvents = [];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  for (const calendarId of calendarsToFetch) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(calendarId)}/events?timeMin=${encodeURIComponent(weekStart.toISOString())}&timeMax=${encodeURIComponent(weekEnd.toISOString())}&singleEvents=true&orderBy=startTime`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Authorization': `Bearer ${state.googleAccessToken}` }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (res.status === 401) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.googleConnected = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.googleAccessToken = null;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('googleAccessToken');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGoogleStatus();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Google ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì—°ê²°í•´ì£¼ì„¸ìš”.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.items) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const events = data.items.map(event => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const start = event.start.dateTime || event.start.date;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let date, time;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (event.start.dateTime) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const d = new Date(start);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date = getLocalDateStr(d);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  time = d.toTimeString().slice(0, 5);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date = start;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  time = null;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return { id: event.id, title: event.summary || '(ì œëª© ì—†ìŒ)', date, time, calendarId };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  allEvents = allEvents.concat(events);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(`Calendar ${calendarId} error:`, e);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  state.googleEvents = allEvents;
Â  Â  Â  Â  Â  Â  Â  Â  renderWeeklyCalendar();
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Google Calendar error:', e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Memos (Post-it) ====================
Â  Â  Â  Â  function renderMemos() {
Â  Â  Â  Â  Â  Â  const grid = document.getElementById('memoGrid');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let html = state.memos.map((m, i) => `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-postit ${m.color || 'yellow'}" onclick="openEditMemo(${i})">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="memo-postit-delete" onclick="deleteMemo(event, ${i})">Ã—</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-postit-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-postit-title">${m.title}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-postit-content">${m.content}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="memo-postit-date">${m.date}</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  html += `<div class="memo-postit memo-postit-add" onclick="openAddMemo()">+</div>`;
Â  Â  Â  Â  Â  Â  grid.innerHTML = html;
Â  Â  Â  Â  }

Â  Â  Â  Â  function openAddMemo() {
Â  Â  Â  Â  Â  Â  document.getElementById('memoModalTitle').textContent = 'ë©”ëª¨ ì¶”ê°€';
Â  Â  Â  Â  Â  Â  document.getElementById('memoEditIndex').value = '-1';
Â  Â  Â  Â  Â  Â  document.getElementById('memoTitle').value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('memoContent').value = '';
Â  Â  Â  Â  Â  Â  selectColor('yellow');
Â  Â  Â  Â  Â  Â  document.getElementById('memoModal').classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  function openEditMemo(index) {
Â  Â  Â  Â  Â  Â  const memo = state.memos[index];
Â  Â  Â  Â  Â  Â  document.getElementById('memoModalTitle').textContent = 'ë©”ëª¨ ìˆ˜ì •';
Â  Â  Â  Â  Â  Â  document.getElementById('memoEditIndex').value = index;
Â  Â  Â  Â  Â  Â  document.getElementById('memoTitle').value = memo.title;
Â  Â  Â  Â  Â  Â  document.getElementById('memoContent').value = memo.content;
Â  Â  Â  Â  Â  Â  selectColor(memo.color || 'yellow');
Â  Â  Â  Â  Â  Â  document.getElementById('memoModal').classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  function selectColor(color) {
Â  Â  Â  Â  Â  Â  state.selectedMemoColor = color;
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.color-option').forEach(el => {
Â  Â  Â  Â  Â  Â  Â  Â  el.classList.toggle('selected', el.dataset.color === color);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveMemo(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const index = parseInt(document.getElementById('memoEditIndex').value);
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  const dateStr = getLocalDateStr(now);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const memo = {
Â  Â  Â  Â  Â  Â  Â  Â  title: document.getElementById('memoTitle').value,
Â  Â  Â  Â  Â  Â  Â  Â  content: document.getElementById('memoContent').value,
Â  Â  Â  Â  Â  Â  Â  Â  color: state.selectedMemoColor,
Â  Â  Â  Â  Â  Â  Â  Â  date: dateStr
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  if (index === -1) {
Â  Â  Â  Â  Â  Â  Â  Â  state.memos.push(memo);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  state.memos[index] = memo;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  renderMemos();
Â  Â  Â  Â  Â  Â  closeModal('memoModal');
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteMemo(e, index) {
Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  if (confirm('ì´ ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
Â  Â  Â  Â  Â  Â  Â  Â  state.memos.splice(index, 1);
Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  renderMemos();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function exportAllMemos() {
Â  Â  Â  Â  Â  Â  if (state.memos.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('ë‚´ë³´ë‚¼ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const wsData = [['ì œëª©', 'ë‚´ìš©', 'ìƒ‰ìƒ', 'ì‘ì„±ì¼']];
Â  Â  Â  Â  Â  Â  state.memos.forEach(m => {
Â  Â  Â  Â  Â  Â  Â  Â  wsData.push([m.title, m.content, m.color, m.date]);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const ws = XLSX.utils.aoa_to_sheet(wsData);
Â  Â  Â  Â  Â  Â  const wb = XLSX.utils.book_new();
Â  Â  Â  Â  Â  Â  XLSX.utils.book_append_sheet(wb, ws, 'ë©”ëª¨');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const filename = `memos_${getLocalDateStr(new Date())}.xlsx`;
Â  Â  Â  Â  Â  Â  XLSX.writeFile(wb, filename);
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== News ====================
Â  Â  Â  Â  function renderNewsKeywords() {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('newsKeywords');
Â  Â  Â  Â  Â  Â  container.innerHTML = state.newsKeywords.map(k => `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="news-keyword ${k === state.activeKeyword ? 'active' : ''}" onclick="selectKeyword('${k}')">${k}</div>
Â  Â  Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function selectKeyword(keyword) {
Â  Â  Â  Â  Â  Â  state.activeKeyword = keyword;
Â  Â  Â  Â  Â  Â  renderNewsKeywords();
Â  Â  Â  Â  Â  Â  loadNews();
Â  Â  Â  Â  }

Â  Â  Â  Â  function openKeywordModal() {
Â  Â  Â  Â  Â  Â  document.getElementById('keywordModal').classList.add('active');
Â  Â  Â  Â  Â  Â  renderKeywordList();
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderKeywordList() {
Â  Â  Â  Â  Â  Â  document.getElementById('keywordList').innerHTML = state.newsKeywords.map(k => `
Â  Â  Â  Â  Â  Â  Â  Â  <span class="news-keyword" onclick="deleteKeyword('${k}')" style="cursor:pointer;">${k} Ã—</span>
Â  Â  Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function addKeyword(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const keyword = document.getElementById('newKeyword').value.trim();
Â  Â  Â  Â  Â  Â  if (keyword && !state.newsKeywords.includes(keyword)) {
Â  Â  Â  Â  Â  Â  Â  Â  state.newsKeywords.push(keyword);
Â  Â  Â  Â  Â  Â  Â  Â  state.activeKeyword = keyword;
Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  renderNewsKeywords();
Â  Â  Â  Â  Â  Â  Â  Â  renderKeywordList();
Â  Â  Â  Â  Â  Â  Â  Â  loadNews();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  document.getElementById('newKeyword').value = '';
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteKeyword(keyword) {
Â  Â  Â  Â  Â  Â  if (state.newsKeywords.length > 1) {
Â  Â  Â  Â  Â  Â  Â  Â  state.newsKeywords = state.newsKeywords.filter(k => k !== keyword);
Â  Â  Â  Â  Â  Â  Â  Â  if (state.activeKeyword === keyword) state.activeKeyword = state.newsKeywords[0];
Â  Â  Â  Â  Â  Â  Â  Â  saveState();
Â  Â  Â  Â  Â  Â  Â  Â  renderNewsKeywords();
Â  Â  Â  Â  Â  Â  Â  Â  renderKeywordList();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // ë‰´ìŠ¤ ë¡œë“œ í•¨ìˆ˜ (news.json íŒŒì¼ì—ì„œ ë¡œë“œ)
Â  Â  Â  Â  async function loadNews() {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('newsList');
Â  Â  Â  Â  Â  Â  list.innerHTML = '<div class="news-loading">ë‰´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>';

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('news.json');
Â  Â  Â  Â  Â  Â  Â  Â  const allNewsData = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (allNewsData[state.activeKeyword]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderNewsItems(allNewsData[state.activeKeyword]);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = `<div class="news-loading">'${state.activeKeyword}'ì— ëŒ€í•œ ë‰´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.<br><small>ë‹¤ìŒ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</small></div>`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = '<div class="news-loading">ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderNewsItems(items) {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('newsList');
Â  Â  Â  Â  Â  Â  list.innerHTML = items.map(item => {
Â  Â  Â  Â  Â  Â  Â  Â  const pubDate = new Date(item.pubDate);
Â  Â  Â  Â  Â  Â  Â  Â  const timeAgo = getTimeAgo(pubDate);
Â  Â  Â  Â  Â  Â  Â  Â  const cleanTitle = item.title.replace(/<[^>]*>/g, '').replace(/&quot;/g, '"').replace(/&amp;/g, '&');

Â  Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="${item.link}" target="_blank" class="news-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="news-title">${cleanTitle}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="news-time">${timeAgo}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function getTimeAgo(date) {
Â  Â  Â  Â  Â  Â  const diff = new Date() - date;
Â  Â  Â  Â  Â  Â  const mins = Math.floor(diff / 60000);
Â  Â  Â  Â  Â  Â  const hrs = Math.floor(diff / 3600000);
Â  Â  Â  Â  Â  Â  const days = Math.floor(diff / 86400000);
Â  Â  Â  Â  Â  Â  if (mins < 1) return 'ë°©ê¸ˆ';
Â  Â  Â  Â  Â  Â  if (mins < 60) return mins + 'ë¶„ ì „';
Â  Â  Â  Â  Â  Â  if (hrs < 24) return hrs + 'ì‹œê°„ ì „';
Â  Â  Â  Â  Â  Â  return days + 'ì¼ ì „';
Â  Â  Â  Â  }

Â  Â  Â  Â  function refreshNews() {
Â  Â  Â  Â  Â  Â  loadNews();
Â  Â  Â  Â  }

Â  Â  Â  Â  // ==================== Modal ====================
Â  Â  Â  Â  function closeModal(id) {
Â  Â  Â  Â  Â  Â  document.getElementById(id).classList.remove('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  document.addEventListener('keydown', e => {
Â  Â  Â  Â  Â  Â  if (e.key === 'Escape') {
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  document.querySelectorAll('.modal-overlay').forEach(overlay => {
Â  Â  Â  Â  Â  Â  overlay.addEventListener('click', e => {
Â  Â  Â  Â  Â  Â  Â  Â  if (e.target === overlay) overlay.classList.remove('active');
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  // Start
Â  Â  Â  Â  init();
Â  Â  </script>
</body>
</html>
